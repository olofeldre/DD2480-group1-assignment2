<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Group1 HTML page</title>

    <!-- update the version number as needed -->
    <script defer src="/__/firebase/8.2.6/firebase-app.js"></script>
    <!-- include only the Firebase features as you need -->
    <script defer src="/__/firebase/8.2.6/firebase-firestore.js"></script>
    <!--
      initialize the SDK after all desired features are loaded, set useEmulator to false
      to avoid connecting the SDK to running emulators.
    -->
    <script defer src="/__/firebase/init.js?useEmulator=true"></script>
  </head>
  <BODY BGCOLOR="WHITE">
  <CENTER>
  <H1>Assignment 2 Fundamentals of Software Engineering</H1>
    <H4>By Group 1</H4>
  <H2>Demonstrating a few featuers this page will have</H2>
  </CENTER>

  <H3>Show the latest build</H3>

  Property (core CI feature #3 - notification): the CI server supports notification of CI results. At least one notification mechanism of the following list is implemented:

  Commit status: the CI server sets the commit status (Länkar till en externa sida.) on the repository (REST API (Länkar till en externa sida.)n for Github)
  Email: the CI server sends an email to the project member about the build result.
  Preparation: The students document in the README how notification has been implemented and unit-tested.

  Assessment: The grader observes the status of the change made while assessing P2. Optionally, the grader may look at the implementation or the tests of this feature.<P>

  <H4>Requirements for P+: Keeping track of build history</H4>

  Property (CI feature): the CI server keeps the history of the past builds. This history persists even if the server is rebooted. Each build is given a unique URL, that is accessible to get the build information (commit identifier, build date, build logs). One URL exists to list all builds.

  Preparation: the students document the build list URL in the README.

  Assessment: The grader opens the build list URL by clicking on it in the README. The grader randomly clicks on a build and assesses the appropriateness of the information.<P>

  <table class="firstTable">
      <tr  class="table-info">
          <th>Commit ID</th>
          <th>Passed tests</th>
          <th>Time</th>
      </tr>

      <tbody id="myTable"></tbody>
  </table>
</BODY>
  <script>
    document.addEventListener('DOMContentLoaded', function() {

      var postArray = [];
      firebase.firestore().collection('test').get().then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
          postArray.push({'commit_id':doc.data().commit_id,
                          'passed_tests': doc.data().passed_tests,
                          'timestamp': doc.data().timestamp.toDate().toString()});
        });

        buildTable(postArray);

      	function buildTable(pArray){
      		var table = document.getElementById('myTable')
      		for (var i = 0; i < pArray.length; i++){
      			var row = `<tr>
      							<td>${pArray[i].commit_id}</td>
      							<td>${pArray[i].passed_tests}</td>
      							<td>${pArray[i].timestamp}</td>
      					  </tr>`
      			table.innerHTML += row
      		}
      	}
      });
  });
  </script>
</html>
